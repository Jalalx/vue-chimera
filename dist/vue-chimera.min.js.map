{"version":3,"file":"vue-chimera.min.js","sources":["../src/utils.js","../src/cache/LocalStorageCache.js","../src/cache/NullCache.js","../node_modules/p-debounce/index.js","../src/Resource.js","../src/NullResource.js","../src/VueChimera.js","../src/mixin.js","../src/index.js","../src/NuxtPlugin.js"],"sourcesContent":["import Axios from 'axios'\n\nexport function isPlainObject (value) {\n  const OBJECT_STRING = '[object Object]'\n  return typeof value === 'object' && Object.prototype.toString(value) === OBJECT_STRING\n}\n\nexport function remove (arr, item) {\n  if (arr.length) {\n    const index = arr.indexOf(item)\n    if (index > -1) {\n      return arr.splice(index, 1)\n    }\n  }\n}\n\nexport function createAxios (config) {\n  if (config instanceof Axios) {\n    return config\n  }\n  if (config && typeof config.$request === 'function') {\n    return config\n  }\n  if (isPlainObject(config)) {\n    return Axios.create(config)\n  }\n  if (typeof config === 'function') {\n    if (typeof config.request === 'function') return config\n    let axios = config()\n    if (axios instanceof Axios) return axios\n  }\n  return Axios\n}\n","export default class LocalStorageCache {\n  constructor (defaultExpiration) {\n    if (typeof window === 'undefined' || !window.localStorage) {\n      throw Error('LocalStorageCache: Local storage is not available.')\n    } else {\n      this.storage = window.localStorage\n    }\n    this.defaultExpiration = defaultExpiration\n  }\n\n  /**\n     *\n     * @param key         Key for the cache\n     * @param value       Value for cache persistence\n     * @param expiration  Expiration time in milliseconds\n     */\n  setItem (key, value, expiration) {\n    this.storage.setItem(key, JSON.stringify({\n      expiration: Date.now() + (expiration || this.defaultExpiration),\n      value\n    }))\n  }\n\n  /**\n     * If Cache exists return the Parsed Value, If Not returns {null}\n     *\n     * @param key\n     */\n  getItem (key) {\n    let item = this.storage.getItem(key)\n    item = JSON.parse(item)\n\n    if (item && item.value && Date.now() <= item.expiration) { return item.value }\n\n    this.removeItem(key)\n    return null\n  }\n\n  removeItem (key) {\n    this.storage.removeItem(key)\n  }\n\n  keys () {\n    return Object.keys(this.storage)\n  }\n\n  all () {\n    return this.keys().reduce((obj, str) => {\n      obj[str] = this.storage.getItem(str)\n      return obj\n    }, {})\n  }\n\n  length () {\n    return this.keys().length\n  }\n\n  clearCache () {\n    this.storage.clear()\n  }\n}\n","export default class NullCache {\n  setItem (key, value, expiration) {}\n\n  getItem (key) {\n    return null\n  }\n\n  removeItem (key) {}\n\n  keys () {\n    return []\n  }\n\n  all () {\n    return {}\n  }\n\n  length () {\n    return 0\n  }\n\n  clearCache () {}\n}\n","'use strict';\nmodule.exports = (fn, wait, opts) => {\n\tif (!Number.isFinite(wait)) {\n\t\tthrow new TypeError('Expected `wait` to be a finite number');\n\t}\n\n\topts = opts || {};\n\n\tlet leadingVal;\n\tlet timer;\n\tlet resolveList = [];\n\n\treturn function () {\n\t\tconst ctx = this;\n\t\tconst args = arguments;\n\n\t\treturn new Promise(resolve => {\n\t\t\tconst runImmediately = opts.leading && !timer;\n\n\t\t\tclearTimeout(timer);\n\n\t\t\ttimer = setTimeout(() => {\n\t\t\t\ttimer = null;\n\n\t\t\t\tconst res = opts.leading ? leadingVal : fn.apply(ctx, args);\n\n\t\t\t\tfor (resolve of resolveList) {\n\t\t\t\t\tresolve(res);\n\t\t\t\t}\n\n\t\t\t\tresolveList = [];\n\t\t\t}, wait);\n\n\t\t\tif (runImmediately) {\n\t\t\t\tleadingVal = fn.apply(ctx, args);\n\t\t\t\tresolve(leadingVal);\n\t\t\t} else {\n\t\t\t\tresolveList.push(resolve);\n\t\t\t}\n\t\t});\n\t};\n};\n","import { isPlainObject, createAxios } from './utils'\nimport LocalStorageCache from './cache/LocalStorageCache'\nimport NullCache from './cache/NullCache'\nimport pDebounce from 'p-debounce'\nimport Axios from 'axios'\nconst { CancelToken } = Axios\n\nexport const EVENT_SUCCESS = 'success'\nexport const EVENT_ERROR = 'error'\nexport const EVENT_CANCEL = 'cancel'\nexport const EVENT_LOADING = 'loading'\nexport const EVENT_TIMEOUT = 'timeout'\n\nexport default class Resource {\n  static from (value, baseOptions = {}) {\n    if (value == null) throw new Error('Cannot create resource from `null`')\n\n    if (value instanceof Resource) { return value }\n\n    if (typeof value === 'string') { return new Resource(value, 'get', baseOptions) }\n\n    if (isPlainObject(value)) {\n      const { url, method, ...options } = value\n      return new Resource(url, method, Object.assign({}, baseOptions, options))\n    }\n  }\n\n  constructor (url, method, options) {\n    options = options || {}\n    method = method ? method.toLowerCase() : 'get'\n    if (method &&\n      ['get', 'post', 'put', 'patch', 'delete'].indexOf(method) === -1) {\n      throw new Error('Bad Method requested: ' + method)\n    }\n\n    this.axios = createAxios(options.axios)\n\n    this.requestConfig = {\n      url: url,\n      method: method ? method.toLowerCase() : 'get',\n      headers: options.headers || {},\n      cancelToken: new CancelToken(c => { this._canceler = c })\n    }\n\n    this.requestConfig[this.requestConfig.method === 'get' ? 'params' : 'data'] = options.params\n\n    this._loading = false\n    this._status = null\n    this._data = null\n    this._headers = null\n    this._error = null\n    this._lastLoaded = null\n    this._eventListeners = {}\n    this.keepData = !!options.keepData\n\n    this.ssrPrefetched = false\n\n    this.prefetch = typeof options.prefetch === 'string' ? options.prefetch.toLowerCase() === method : Boolean(options.prefetch)\n    this.ssrPrefetch = options.ssrPrefetch\n    this.cache = this.getCache(options.cache)\n    this.fetchDebounced = pDebounce(this.fetch.bind(this), options.debounce || 80, { leading: true })\n\n    // Set Transformers\n    if (options.transformer) {\n      if (typeof options.transformer === 'function') {\n        this.setTransformer(options.transformer)\n      } else if (typeof options.transformer === 'object') {\n        this.setResponseTransformer(options.transformer.response)\n        this.setErrorTransformer(options.transformer.error)\n      }\n    }\n    this.responseTransformer = this.responseTransformer || (r => r)\n    this.errorTransformer = this.errorTransformer || (r => r)\n\n    // Set interval.\n    if (options.interval) {\n      this.startInterval(options.interval)\n    }\n\n    // Set Events\n    if (typeof options.on === 'object' && options.on) {\n      for (let key in options.on) {\n        this.on(key, options.on[key])\n      }\n    }\n  }\n\n  setResponseTransformer (transformer) {\n    this.responseTransformer = transformer\n  }\n\n  setErrorTransformer (transformer) {\n    this.errorTransformer = transformer\n  }\n\n  setTransformer (transformer) {\n    this.responseTransformer = transformer\n    this.errorTransformer = transformer\n  }\n\n  startInterval (ms) {\n    if (typeof process !== 'undefined' && process.server) return\n\n    if (ms) this._interval = ms\n    this.stopInterval()\n    this._interval_id = setInterval(() => this.reload(true), this._interval)\n  }\n\n  stopInterval () {\n    if (this._interval_id) clearInterval(this._interval_id)\n  }\n\n  on (event, handler) {\n    let listeners = this._eventListeners[event] || []\n    listeners.push(handler)\n    this._eventListeners[event] = listeners\n    return this\n  }\n\n  bindListeners (obj) {\n    Object.keys(this._eventListeners).forEach(key => {\n      (this._eventListeners[key] || []).forEach((handler, i) => {\n        this._eventListeners[key][i] = handler.bind(obj)\n      })\n    })\n  }\n\n  emit (event) {\n    (this._eventListeners[event] || []).forEach(handler => {\n      handler(this)\n    })\n  }\n\n  fetch (force, extraData) {\n    return new Promise((resolve, reject) => {\n      let setByResponse = (res) => {\n        this._error = null\n        this._loading = false\n        if (res) {\n          this._status = res.status\n          this._data = this.responseTransformer(res.data)\n          this._headers = res.headers\n          this._lastLoaded = new Date()\n        }\n      }\n\n      if (this.cache && !force) {\n        let cacheValue = this.cache.getItem(this.getCacheKey())\n        if (cacheValue) {\n          setByResponse(cacheValue)\n          resolve(cacheValue)\n          return\n        }\n      }\n\n      this._loading = true\n      this.emit(EVENT_LOADING)\n\n      // Assign Extra data\n      let requestConfig = Object.assign({}, this.requestConfig, typeof extraData === 'object' ? {\n        [this.requestConfig.method === 'get' ? 'params' : 'data']: extraData\n      } : {})\n\n      this.axios.request(requestConfig).then(res => {\n        setByResponse(res)\n        this.setCache(res)\n        this.emit(EVENT_SUCCESS)\n        resolve(res)\n      }).catch(err => {\n        this._data = null\n        this._loading = false\n        const errorResponse = err.response\n        if (errorResponse) {\n          this._status = errorResponse.status\n          this._error = this.errorTransformer(errorResponse.data)\n          this._headers = errorResponse.headers\n        }\n        if (Axios.isCancel(err)) {\n          this.emit(EVENT_CANCEL)\n        } else if (err.message && !err.response && err.message.indexOf('timeout') !== -1) {\n          this.emit(EVENT_TIMEOUT)\n        } else {\n          this.emit(EVENT_ERROR)\n        }\n\n        reject(err)\n      })\n    })\n  }\n\n  reload (force) {\n    return this.fetchDebounced(force)\n  }\n\n  execute () {\n    return this.fetchDebounced(true)\n  }\n\n  send (extra) {\n    return this.fetchDebounced(true, extra)\n  }\n\n  cancel (unload) {\n    this.stopInterval()\n    if (unload) this._data = null\n    if (typeof this._canceler === 'function') this._canceler()\n    this.requestConfig.cancelToken = new CancelToken(c => { this._canceler = c })\n  }\n\n  stop () {\n    this.cancel()\n  }\n\n  getCache (cache) {\n    const caches = {\n      'no-cache': () => new NullCache(),\n      'localStorage': () => new LocalStorageCache(this.getConfig().cacheExpiration || 10000)\n    }\n    cache = cache || 'no-cache'\n    return caches[cache] ? caches[cache]() : null\n  }\n\n  getCacheKey () {\n    return (typeof window !== 'undefined' && typeof btoa !== 'undefined'\n      ? window.btoa\n      : x => x)(this.requestConfig.url +\n      this.requestConfig.params +\n      this.requestConfig.data +\n      this.requestConfig.method)\n  }\n\n  setCache (value) {\n    if (this.cache) { this.cache.setItem(this.getCacheKey(), value) }\n  }\n\n  toJSON () {\n    const json = {};\n    ['_loading', '_status', '_data', '_headers', '_error', '_lastLoaded', 'ssrPrefetched'].forEach(key => {\n      json[key] = this[key]\n    })\n    return JSON.stringify(json)\n  }\n\n  get loading () {\n    return this._loading\n  }\n\n  get status () {\n    return this._status\n  }\n\n  get data () {\n    return this._data\n  }\n\n  get headers () {\n    return this._headers\n  }\n\n  get error () {\n    return this._error\n  }\n\n  get lastLoaded () {\n    return this._lastLoaded\n  }\n}\n","import Resource from './Resource'\n\nexport default class NullResource extends Resource {\n  fetch (force) {\n    return Promise.reject(new Error('Null Resource'))\n  }\n\n  cancel () {}\n\n  get loading () {\n    return false\n  }\n\n  get status () {\n    return 0\n  }\n\n  get data () {\n    return null\n  }\n\n  get error () {\n    return null\n  }\n\n  get lastLoaded () {\n    return null\n  }\n}\n","import Resource from './Resource'\nimport NullResource from './NullResource'\nimport { createAxios } from './utils'\n\nexport default class VueChimera {\n  constructor (vm, resources, options) {\n    this._vm = vm\n    this._reactiveResources = {}\n    this.options = options || {}\n\n    this.axios = this.options.axios = (!this.options.axios && this._vm.$axios) ? this._vm.$axios : createAxios(this.options.axios)\n\n    const vmOptions = this._vm.$options\n    vmOptions.computed = vmOptions.computed || {}\n    vmOptions.watch = vmOptions.watch || {}\n\n    resources = Object.assign({}, resources)\n\n    for (let key in resources) {\n      if (key.charAt(0) === '$' || !resources.hasOwnProperty(key)) continue\n\n      let r = resources[key]\n\n      if (typeof r === 'function') {\n        r = r.bind(this._vm)\n        resources[key] = new NullResource()\n        this._reactiveResources[key] = r\n        vmOptions.computed['$_chimera__' + key] = r\n        vmOptions.watch['$_chimera__' + key] = (t) => this.updateReactiveResource(key, t)\n      } else {\n        resources[key] = Resource.from(r, this.options)\n      }\n      vmOptions.computed[key] = () => resources[key]\n      resources[key].bindListeners(this._vm)\n    }\n\n    Object.defineProperty(resources, '$cancelAll', { value: this.cancelAll.bind(this) })\n    Object.defineProperty(resources, '$axios', { get: () => this.axios })\n    Object.defineProperty(resources, '$loading', {\n      get () {\n        for (let r in this) {\n          if (r.loading) return true\n        }\n        return false\n      }\n    })\n    this.resources = resources\n  }\n\n  updateReactiveResources () {\n    Object.keys(this._reactiveResources).forEach(key => {\n      this.updateReactiveResource(key)\n    })\n  }\n\n  updateReactiveResource (key) {\n    const oldResource = this.resources[key]\n    oldResource.stopInterval()\n    let r = Resource.from(this._reactiveResources[key].call(this._vm), this.options)\n\n    // Keep data\n    if (oldResource.keepData) {\n      r._data = oldResource._data\n      r._status = oldResource._status\n      r._headers = oldResource._headers\n      r._error = oldResource._error\n    }\n\n    r._lastLoaded = oldResource._lastLoaded\n    if (r.prefetch) r.reload()\n    this.resources[key] = r\n  }\n\n  cancelAll () {\n    Object.keys(this.resources).forEach(r => {\n      this.resources[r].cancel()\n    })\n  }\n}\n","import VueChimera from './VueChimera'\nimport { isPlainObject } from './utils'\n\nexport default (config = {}) => ({\n  beforeCreate () {\n    const options = this.$options\n    let _chimera\n\n    // Stop if instance doesn't have chimera or already initialized\n    if (!options.chimera || options._chimera) return\n\n    if (typeof options.chimera === 'function') {\n      // Initialize with function\n      options.chimera = options.chimera.call(this)\n    }\n\n    if (options.chimera instanceof VueChimera) {\n      _chimera = options.chimera\n    } else if (isPlainObject(options.chimera)) {\n      const { $options, ...resources } = options.chimera\n      _chimera = new VueChimera(\n        this, resources, { ...config, ...$options }\n      )\n    }\n\n    options.computed = options.computed || {}\n    options.watch = options.watch || {}\n\n    // Nuxtjs prefetch\n    const NUXT = typeof process !== 'undefined' && process.server && this.$ssrContext\n      ? this.$ssrContext.nuxt\n      : (typeof window !== 'undefined' ? window.__NUXT__ : null)\n    if (_chimera && NUXT && NUXT.chimera) {\n      try {\n        if (this.$router) {\n          let matched = this.$router.match(this.$router.currentRoute.fullPath);\n          (matched ? matched.matched : []).forEach((m, i) => {\n            let nuxtChimera = NUXT.chimera[i]\n            if (nuxtChimera) {\n              Object.keys(_chimera.resources).forEach(key => {\n                let localResource = _chimera.resources[key]\n                let ssrResource = nuxtChimera[key]\n                if (localResource && ssrResource && ssrResource._data) {\n                  [\n                    '_data', '_status', '_headers', 'ssrPrefetched',\n                    '_lastLoaded'].forEach(key => {\n                    localResource[key] = ssrResource[key]\n                  })\n                }\n              })\n            }\n          })\n          // if (process.client) {\n          //   delete NUXT.chimera\n          // }\n        }\n      } catch (e) {}\n    }\n    this._chimera = _chimera\n  },\n\n  data () {\n    if (this._chimera) {\n      return { $chimera: this._chimera.resources }\n    }\n    return {}\n  },\n\n  mounted () {\n    if (this._chimera) {\n      this._chimera.updateReactiveResources()\n      for (let r in this._chimera.resources) {\n        let resource = this._chimera.resources[r]\n        if (resource.prefetch && (!resource.ssrPrefetched || resource.ssrPrefetch === 'override')) {\n          resource.reload()\n        }\n      }\n    }\n  },\n\n  beforeDestroy () {\n    if (!this._chimera) {\n      return\n    }\n\n    this._chimera.cancelAll()\n    this._chimera = null\n    delete this._chimera\n  }\n})\n","import mixin from './mixin'\nimport NuxtPlugin from './NuxtPlugin'\n\nconst plugin = {\n\n  options: {\n    axios: null,\n    cache: 'no-cache',\n    debounce: 80,\n    prefetch: 'get', // false, true, '%METHOD%',\n    ssrPrefetch: true,\n    ssrPrefetchTimeout: 4000,\n    transformer: null,\n    headers: null\n  },\n\n  install (Vue, options = {}) {\n    Object.keys(options).forEach(key => {\n      if (key in this.options) {\n        this.options[key] = options[key]\n      }\n    })\n\n    if (!Vue.prototype.hasOwnProperty('$chimera')) {\n      Object.defineProperty(Vue.prototype, '$chimera', {\n        get () {\n          if (this._chimera) {\n            return this._chimera.resources\n          }\n          return null\n        }\n      })\n    }\n\n    Vue.mixin(mixin(this.options))\n  },\n\n  NuxtPlugin\n\n}\n\n// Auto-install\nlet GlobalVue = null\nif (typeof window !== 'undefined') {\n  GlobalVue = window.Vue\n} else if (typeof global !== 'undefined') {\n  GlobalVue = global.Vue\n}\n\nif (GlobalVue) {\n  GlobalVue.use(plugin, plugin.options)\n}\n\nexport default plugin\n","import Resource from './Resource'\n\nexport default function () {\n  this.options = this.options || {}\n  const baseOptions = this.options\n\n  return function ({ beforeNuxtRender, isDev, $axios }) {\n    if (!beforeNuxtRender) { return }\n\n    const cancelTokens = []\n    async function prefetchAsyncData ({ Components, nuxtState }) {\n      nuxtState.chimera = nuxtState.chimera || {}\n\n      for (let i = 0, len = Components.length; i < len; i++) {\n        let component = Components[i]\n        let chimera = component.options ? component.options.chimera : null\n\n        if (typeof chimera === 'function') {\n          // Append @Nuxtjs/axios to component (maybe needed by constructor)\n          if ($axios && !component.$axios) component.$axios = $axios\n          chimera = chimera.bind(component)()\n        }\n\n        if (!chimera) { continue }\n\n        const nuxtChimera = {}\n        const { $options, ...resources } = chimera\n        const options = Object.assign({}, baseOptions, $options)\n        if (!options.axios) options.axios = $axios\n\n        for (let key in resources) {\n          let resource = resources[key]\n          if (resource && typeof resource !== 'function') {\n            resource = resource && resource._data ? resource : Resource.from(resource, options)\n            cancelTokens.push(resource.cancel.bind(resource))\n            if (!resource.prefetch || !resource.ssrPrefetch) continue\n            try {\n              isDev && console.log('  Prefetching: ' + resource.requestConfig.url) // eslint-disable-line no-console\n              let response = await resource.execute()\n              resource._data = response.data\n            } catch (err) {\n              isDev && console.error(err.message) // eslint-disable-line no-console\n            }\n            resource.ssrPrefetched = true\n            resources[key] = nuxtChimera[key] = resource\n          }\n        }\n        if (Object.keys(nuxtChimera).length) {\n          nuxtState.chimera[i] = nuxtChimera\n        }\n      }\n    }\n\n    beforeNuxtRender((...args) => {\n      return new Promise((resolve, reject) => {\n        prefetchAsyncData(...args).then(resolve).catch(reject)\n        setTimeout(reject, baseOptions.ssrPrefetchTimeout, new Error('  SSR Prefetch Timeout.'))\n      }).catch(err => {\n        for (let cancel of cancelTokens) if (typeof cancel === 'function') cancel()\n        isDev && console.error(err.message) // eslint-disable-line no-console\n      })\n    })\n  }\n}\n"],"names":["isPlainObject","value","Object","prototype","toString","createAxios","config","Axios","$request","create","request","axios","LocalStorageCache","constructor","defaultExpiration","window","localStorage","Error","storage","setItem","key","expiration","JSON","stringify","Date","now","this","getItem","item","parse","removeItem","keys","all","reduce","obj","str","length","clearCache","clear","NullCache","fn","wait","opts","Number","isFinite","TypeError","leadingVal","timer","resolveList","ctx","args","arguments","Promise","resolve","runImmediately","leading","clearTimeout","setTimeout","res","apply","push","CancelToken","EVENT_SUCCESS","EVENT_ERROR","EVENT_CANCEL","EVENT_LOADING","EVENT_TIMEOUT","Resource","baseOptions","url","method","options","assign","toLowerCase","indexOf","requestConfig","headers","cancelToken","c","_canceler","params","_loading","_status","_data","_headers","_error","_lastLoaded","_eventListeners","keepData","ssrPrefetched","prefetch","Boolean","ssrPrefetch","cache","getCache","fetchDebounced","pDebounce","fetch","bind","debounce","transformer","setTransformer","setResponseTransformer","response","setErrorTransformer","error","responseTransformer","r","errorTransformer","interval","startInterval","on","ms","process","server","_interval","stopInterval","_interval_id","setInterval","reload","clearInterval","event","handler","listeners","bindListeners","forEach","i","emit","force","extraData","reject","setByResponse","status","data","cacheValue","getCacheKey","then","setCache","catch","err","errorResponse","isCancel","message","execute","send","extra","cancel","unload","stop","caches","getConfig","cacheExpiration","btoa","x","toJSON","json","NullResource","VueChimera","vm","resources","_vm","_reactiveResources","$axios","vmOptions","$options","computed","watch","charAt","hasOwnProperty","t","updateReactiveResource","from","defineProperty","cancelAll","get","loading","updateReactiveResources","oldResource","call","beforeCreate","_chimera","chimera","NUXT","$ssrContext","nuxt","__NUXT__","$router","matched","match","currentRoute","fullPath","m","nuxtChimera","localResource","ssrResource","e","$chimera","mounted","resource","beforeDestroy","plugin","ssrPrefetchTimeout","install","Vue","mixin","NuxtPlugin","beforeNuxtRender","isDev","cancelTokens","Components","nuxtState","len","component","console","log","prefetchAsyncData","GlobalVue","global","use"],"mappings":"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"}